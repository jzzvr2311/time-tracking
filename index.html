<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#3B82F6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Time Tracking">
    <title>Biometric Time Tracking</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        * {
            -webkit-tap-highlight-color: transparent;
        }
        body {
            margin: 0;
            padding: 0;
            overscroll-behavior: none;
            -webkit-user-select: none;
            user-select: none;
        }
        .app-container {
            min-height: 100vh;
            min-height: -webkit-fill-available;
        }
        input, select, button, textarea {
            -webkit-user-select: text;
            user-select: text;
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;

        // GitHub Personal Access Token for anonymous gist access
        // This is a public token with ONLY gist create/update permissions
        const GITHUB_TOKEN = 'github_pat_11BHKE7JQ0oPdLLILWFCNP_VPqhHKQiPd45y6xAYfZpMBhBGf7C8kSFJQ0123456789';

        const Clock = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12 6 12 12 16 14"></polyline>
            </svg>
        );

        const Download = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                <polyline points="7 10 12 15 17 10"></polyline>
                <line x1="12" y1="15" x2="12" y2="3"></line>
            </svg>
        );

        const LogIn = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4"></path>
                <polyline points="10 17 15 12 10 7"></polyline>
                <line x1="15" y1="12" x2="3" y2="12"></line>
            </svg>
        );

        const LogOut = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"></path>
                <polyline points="16 17 21 12 16 7"></polyline>
                <line x1="21" y1="12" x2="9" y2="12"></line>
            </svg>
        );

        const Trash2 = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
            </svg>
        );

        const Filter = () => (
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"></polygon>
            </svg>
        );

        const X = () => (
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <line x1="18" y1="6" x2="6" y2="18"></line>
                <line x1="6" y1="6" x2="18" y2="18"></line>
            </svg>
        );

        const Lock = () => (
            <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
            </svg>
        );

        const BiometricTimeTracking = () => {
            const [isLoggedIn, setIsLoggedIn] = useState(false);
            const [accessCode, setAccessCode] = useState('');
            const [inputCode, setInputCode] = useState('');
            const [currentTime, setCurrentTime] = useState(new Date());
            const [employeeName, setEmployeeName] = useState('Jazzver Lotoc');
            const [timeInRecorded, setTimeInRecorded] = useState(null);
            const [timeOutRecorded, setTimeOutRecorded] = useState(null);
            const [records, setRecords] = useState([]);
            const [showNotification, setShowNotification] = useState(false);
            const [notificationMessage, setNotificationMessage] = useState('');
            const [isLoading, setIsLoading] = useState(true);
            const [filterDate, setFilterDate] = useState('');
            const [filterDay, setFilterDay] = useState('');
            const [showDeleteConfirm, setShowDeleteConfirm] = useState(false);
            const [showClearConfirm, setShowClearConfirm] = useState(false);
            const [recordToDelete, setRecordToDelete] = useState(null);
            const [showFilters, setShowFilters] = useState(false);
            const [showTimeInConfirm, setShowTimeInConfirm] = useState(false);
            const [showTimeOutConfirm, setShowTimeOutConfirm] = useState(false);
            const [showExportConfirm, setShowExportConfirm] = useState(false);
            const [gistId, setGistId] = useState('');
            const [isSyncing, setIsSyncing] = useState(false);

            useEffect(() => {
                const savedCode = localStorage.getItem('access-code');
                const savedToken = localStorage.getItem('github-token');
                
                if (savedToken) {
                    setGithubToken(savedToken);
                }
                
                if (savedCode && savedToken) {
                    setAccessCode(savedCode);
                    setIsLoggedIn(true);
                    loadDataFromCloud(savedCode, savedToken);
                } else {
                    setIsLoading(false);
                }
            }, []);

            useEffect(() => {
                const timer = setInterval(() => {
                    setCurrentTime(new Date());
                }, 1000);
                return () => clearInterval(timer);
            }, []);

            // Hash function to convert access code to consistent gist ID
            const hashCode = async (str) => {
                const encoder = new TextEncoder();
                const data = encoder.encode(str);
                const hashBuffer = await crypto.subtle.digest('SHA-256', data);
                const hashArray = Array.from(new Uint8Array(hashBuffer));
                const hashHex = hashArray.map(b => b.toString(16).padStart(2, '0')).join('');
                return hashHex.substring(0, 32); // Use first 32 chars as gist description
            };

            const loadDataFromCloud = async (code, token) => {
                setIsSyncing(true);
                try {
                    const hash = await hashCode(code);
                    
                    // Search for existing gist with this hash
                    const response = await fetch('https://api.github.com/gists', {
                        headers: {
                            'Authorization': `token ${token}`
                        }
                    });

                    if (response.ok) {
                        const gists = await response.json();
                        const existingGist = gists.find(g => g.description === `TimeTrack_${hash}`);
                        
                        if (existingGist) {
                            setGistId(existingGist.id);
                            const fileContent = existingGist.files['data.json']?.content;
                            if (fileContent) {
                                const data = JSON.parse(fileContent);
                                setRecords(data.records || []);
                                setEmployeeName(data.employeeName || 'Jazzver Lotoc');
                                showNotif(`‚úì Loaded ${data.records?.length || 0} records`);
                            }
                        } else {
                            // Create new gist for this access code
                            await createNewGist(code, hash, token);
                        }
                    }
                } catch (error) {
                    console.error('Load error:', error);
                    showNotif('Using local storage only');
                } finally {
                    setIsLoading(false);
                    setIsSyncing(false);
                }
            };

            const createNewGist = async (code, hash, token) => {
                try {
                    const data = {
                        records: [],
                        employeeName: 'Jazzver Lotoc',
                        lastSync: new Date().toISOString()
                    };

                    const response = await fetch('https://api.github.com/gists', {
                        method: 'POST',
                        headers: {
                            'Authorization': `token ${token}`,
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            description: `TimeTrack_${hash}`,
                            public: false,
                            files: {
                                'data.json': {
                                    content: JSON.stringify(data, null, 2)
                                }
                            }
                        })
                    });

                    if (response.ok) {
                        const gist = await response.json();
                        setGistId(gist.id);
                        showNotif('‚úì Cloud storage created');
                    }
                } catch (error) {
                    console.error('Create gist error:', error);
                }
            };

            const saveData = async (newRecords, empName) => {
                // Save locally first
                localStorage.setItem('local-data', JSON.stringify({
                    records: newRecords,
                    employeeName: empName
                }));

                // Sync to cloud if logged in and have token
                if (isLoggedIn && gistId && githubToken) {
                    setIsSyncing(true);
                    try {
                        const data = {
                            records: newRecords,
                            employeeName: empName,
                            lastSync: new Date().toISOString()
                        };

                        await fetch(`https://api.github.com/gists/${gistId}`, {
                            method: 'PATCH',
                            headers: {
                                'Authorization': `token ${githubToken}`,
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                files: {
                                    'data.json': {
                                        content: JSON.stringify(data, null, 2)
                                    }
                                }
                            })
                        });
                    } catch (error) {
                        console.error('Sync error:', error);
                    } finally {
                        setIsSyncing(false);
                    }
                }
            };

            const handleLogin = async () => {
                if (!inputCode || inputCode.length < 4) {
                    showNotif('Access code must be at least 4 characters');
                    return;
                }

                // Check if we need GitHub token
                const savedToken = localStorage.getItem('github-token');
                if (!savedToken) {
                    setNeedsToken(true);
                    return;
                }

                setIsLoading(true);
                localStorage.setItem('access-code', inputCode);
                setAccessCode(inputCode);
                setGithubToken(savedToken);
                setIsLoggedIn(true);
                await loadDataFromCloud(inputCode, savedToken);
            };

            const handleTokenSetup = async () => {
                if (!inputToken || inputToken.length < 20) {
                    showNotif('Please enter a valid GitHub token');
                    return;
                }

                setIsLoading(true);
                localStorage.setItem('github-token', inputToken);
                localStorage.setItem('access-code', inputCode);
                setGithubToken(inputToken);
                setAccessCode(inputCode);
                setIsLoggedIn(true);
                setNeedsToken(false);
                await loadDataFromCloud(inputCode, inputToken);
            };

            const handleLogout = () => {
                localStorage.removeItem('access-code');
                setAccessCode('');
                setIsLoggedIn(false);
                setRecords([]);
                setEmployeeName('Jazzver Lotoc');
                showNotif('‚úì Logged out');
            };

            const formatTime = (date) => {
                return date.toLocaleTimeString('en-US', { 
                    hour12: false,
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                });
            };

            const formatDate = (date) => {
                return date.toLocaleDateString('en-US', {
                    month: 'long',
                    day: '2-digit',
                    year: 'numeric'
                });
            };

            const formatDateShort = (date) => {
                return date.toLocaleDateString('en-US', {
                    month: 'short',
                    day: '2-digit',
                    year: 'numeric'
                });
            };

            const getDayOfWeek = (dateString) => {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-US', { weekday: 'long' });
            };

            const showNotif = (message) => {
                setNotificationMessage(message);
                setShowNotification(true);
                setTimeout(() => setShowNotification(false), 3000);
            };

            const handleTimeIn = () => {
                const hasPendingRecord = records.some(record => !record.timeOut);
                if (hasPendingRecord) {
                    showNotif('Please log Time Out first');
                    return;
                }
                setShowTimeInConfirm(true);
            };

            const confirmTimeIn = () => {
                const now = new Date();
                setTimeInRecorded(now);
                setTimeOutRecorded(null);
                
                const newRecord = {
                    date: formatDateShort(now),
                    name: employeeName,
                    timeIn: formatTime(now),
                    timeOut: '',
                    id: Date.now(),
                    dayOfWeek: getDayOfWeek(now)
                };
                
                const updatedRecords = [newRecord, ...records];
                setRecords(updatedRecords);
                saveData(updatedRecords, employeeName);
                showNotif('Time In Recorded ‚úì');
                setShowTimeInConfirm(false);
            };

            const handleTimeOut = () => {
                setShowTimeOutConfirm(true);
            };

            const confirmTimeOut = () => {
                const now = new Date();
                const updatedRecords = [...records];
                const recordToUpdate = updatedRecords.find(record => !record.timeOut);
                
                if (recordToUpdate) {
                    recordToUpdate.timeOut = formatTime(now);
                    setTimeOutRecorded(now);
                    setRecords(updatedRecords);
                    saveData(updatedRecords, employeeName);
                    showNotif('Time Out Recorded ‚úì');
                } else {
                    showNotif('Please log Time In first');
                }
                setShowTimeOutConfirm(false);
            };

            const handleEmployeeNameChange = (value) => {
                setEmployeeName(value);
                saveData(records, value);
            };

            const deleteRecord = (id) => {
                setRecordToDelete(id);
                setShowDeleteConfirm(true);
            };

            const confirmDelete = () => {
                if (recordToDelete) {
                    const updatedRecords = records.filter(record => record.id !== recordToDelete);
                    setRecords(updatedRecords);
                    saveData(updatedRecords, employeeName);
                    showNotif('Record deleted');
                    setShowDeleteConfirm(false);
                    setRecordToDelete(null);
                }
            };

            const clearAllData = () => {
                setShowClearConfirm(true);
            };

            const confirmClearAll = () => {
                const updatedRecords = [];
                setRecords(updatedRecords);
                saveData(updatedRecords, employeeName);
                showNotif('All records cleared');
                setShowClearConfirm(false);
            };

            const clearFilters = () => {
                setFilterDate('');
                setFilterDay('');
            };

            const filteredRecords = records.filter(record => {
                let matchesDate = true;
                let matchesDay = true;

                if (filterDate) {
                    const recordDate = new Date(record.date);
                    const selectedDate = new Date(filterDate);
                    matchesDate = recordDate.toDateString() === selectedDate.toDateString();
                }

                if (filterDay) {
                    matchesDay = record.dayOfWeek === filterDay;
                }

                return matchesDate && matchesDay;
            });

            const exportToExcel = () => {
                setShowExportConfirm(true);
            };

            const confirmExport = () => {
                const dataToExport = filteredRecords.length > 0 ? filteredRecords : records;
                let csv = 'DATE,DAY,NAME,TIME IN,TIME OUT\n';
                dataToExport.forEach(record => {
                    csv += `${record.date},${record.dayOfWeek || ''},${record.name},${record.timeIn},${record.timeOut || ''}\n`;
                });
                
                const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
                const link = document.createElement('a');
                if (link.download !== undefined) {
                    const url = URL.createObjectURL(blob);
                    link.setAttribute('href', url);
                    link.setAttribute('download', 'time_tracking_records.csv');
                    link.style.visibility = 'hidden';
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                }
                setShowExportConfirm(false);
                showNotif('‚úì Exported to Excel');
            };

            if (isLoading) {
                return (
                    <div className="app-container bg-gray-50 flex items-center justify-center">
                        <div className="text-gray-600">Loading...</div>
                    </div>
                );
            }

            if (!isLoggedIn) {
                if (needsToken) {
                    return (
                        <div className="app-container bg-gradient-to-br from-purple-500 to-purple-600 flex items-center justify-center p-4">
                            <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
                                <div className="text-center mb-8">
                                    <div className="flex justify-center mb-4">
                                        <div className="bg-purple-100 p-4 rounded-full">
                                            <Lock />
                                        </div>
                                    </div>
                                    <h1 className="text-3xl font-bold text-gray-800">GitHub Setup</h1>
                                    <p className="text-gray-600 mt-2">First time setup - needed once</p>
                                </div>

                                <div className="space-y-4">
                                    <div className="bg-purple-50 border border-purple-200 rounded-xl p-4 text-sm">
                                        <p className="font-bold text-purple-900 mb-2">üìã Quick Setup:</p>
                                        <ol className="space-y-1 text-purple-800 text-xs">
                                            <li>1. Go to github.com/settings/tokens</li>
                                            <li>2. Click "Generate new token (classic)"</li>
                                            <li>3. Name it: Time Tracking</li>
                                            <li>4. Check ONLY "gist" permission</li>
                                            <li>5. Generate & copy the token</li>
                                            <li>6. Paste it below</li>
                                        </ol>
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">GitHub Token</label>
                                        <textarea
                                            value={inputToken}
                                            onChange={(e) => setInputToken(e.target.value)}
                                            className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-purple-500 focus:border-purple-500 text-sm font-mono"
                                            placeholder="ghp_xxxxxxxxxxxx"
                                            rows="3"
                                        />
                                        <p className="text-xs text-gray-500 mt-2">
                                            üîí Stored securely on your device only
                                        </p>
                                    </div>

                                    <button
                                        onClick={handleTokenSetup}
                                        className="w-full py-3 bg-purple-500 hover:bg-purple-600 text-white font-bold rounded-xl transition-colors text-lg"
                                        disabled={isLoading}
                                    >
                                        {isLoading ? 'Setting up...' : 'Complete Setup'}
                                    </button>

                                    <button
                                        onClick={() => setNeedsToken(false)}
                                        className="w-full py-2 text-gray-600 hover:text-gray-800"
                                    >
                                        ‚Üê Back
                                    </button>
                                </div>
                            </div>
                        </div>
                    );
                }

                return (
                    <div className="app-container bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center p-4">
                        <div className="bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full">
                            <div className="text-center mb-8">
                                <div className="flex justify-center mb-4">
                                    <div className="bg-blue-100 p-4 rounded-full">
                                        <Lock />
                                    </div>
                                </div>
                                <h1 className="text-3xl font-bold text-gray-800">Time Tracking</h1>
                                <p className="text-gray-600 mt-2">Enter your access code</p>
                            </div>

                            <div className="space-y-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Access Code</label>
                                    <input
                                        type="password"
                                        value={inputCode}
                                        onChange={(e) => setInputCode(e.target.value)}
                                        onKeyPress={(e) => e.key === 'Enter' && handleLogin()}
                                        className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-lg text-center"
                                        placeholder="Enter your code"
                                        autoFocus
                                    />
                                    <p className="text-xs text-gray-500 mt-2 text-center">
                                        Minimum 4 characters ‚Ä¢ This code will be used to access your data on all devices
                                    </p>
                                </div>

                                <button
                                    onClick={handleLogin}
                                    className="w-full py-3 bg-blue-500 hover:bg-blue-600 text-white font-bold rounded-xl transition-colors text-lg"
                                >
                                    Access
                                </button>
                            </div>

                            <div className="mt-6 p-4 bg-blue-50 border border-blue-200 rounded-xl text-sm text-blue-800">
                                <p className="font-semibold mb-2">üí° How it works:</p>
                                <ul className="space-y-1 text-xs">
                                    <li>‚Ä¢ Create any code you'll remember</li>
                                    <li>‚Ä¢ Use the same code on all your devices</li>
                                    <li>‚Ä¢ Your data syncs automatically to cloud</li>
                                    <li>‚Ä¢ GitHub token needed once (per device)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="app-container bg-gray-50">
                    {showNotification && (
                        <div className="fixed top-4 left-4 right-4 bg-green-500 text-white px-4 py-3 rounded-xl shadow-lg z-50 text-center font-medium">
                            {notificationMessage}
                        </div>
                    )}

                    {showTimeInConfirm && (
                        <div className="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl">
                                <h3 className="text-xl font-bold text-gray-800 mb-3">Clock In Now?</h3>
                                <p className="text-gray-600 mb-6">Record your time in at {formatTime(new Date())}?</p>
                                <div className="flex gap-3">
                                    <button onClick={() => setShowTimeInConfirm(false)} className="flex-1 px-4 py-3 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-xl transition-colors font-medium">
                                        Cancel
                                    </button>
                                    <button onClick={confirmTimeIn} className="flex-1 px-4 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-xl transition-colors font-medium">
                                        Confirm
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showTimeOutConfirm && (
                        <div className="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl">
                                <h3 className="text-xl font-bold text-gray-800 mb-3">Clock Out Now?</h3>
                                <p className="text-gray-600 mb-6">Record your time out at {formatTime(new Date())}?</p>
                                <div className="flex gap-3">
                                    <button onClick={() => setShowTimeOutConfirm(false)} className="flex-1 px-4 py-3 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-xl transition-colors font-medium">
                                        Cancel
                                    </button>
                                    <button onClick={confirmTimeOut} className="flex-1 px-4 py-3 bg-gray-700 hover:bg-gray-800 text-white rounded-xl transition-colors font-medium">
                                        Confirm
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showExportConfirm && (
                        <div className="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl">
                                <h3 className="text-xl font-bold text-gray-800 mb-3">Export to Excel?</h3>
                                <p className="text-gray-600 mb-6">
                                    Export {filteredRecords.length > 0 && filteredRecords.length !== records.length 
                                        ? `${filteredRecords.length} filtered records` 
                                        : `${records.length} records`} to CSV file?
                                </p>
                                <div className="flex gap-3">
                                    <button onClick={() => setShowExportConfirm(false)} className="flex-1 px-4 py-3 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-xl transition-colors font-medium">
                                        Cancel
                                    </button>
                                    <button onClick={confirmExport} className="flex-1 px-4 py-3 bg-green-500 hover:bg-green-600 text-white rounded-xl transition-colors font-medium">
                                        Export
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showDeleteConfirm && (
                        <div className="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl">
                                <h3 className="text-xl font-bold text-gray-800 mb-3">Delete Record?</h3>
                                <p className="text-gray-600 mb-6">This action cannot be undone.</p>
                                <div className="flex gap-3">
                                    <button onClick={() => setShowDeleteConfirm(false)} className="flex-1 px-4 py-3 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-xl transition-colors font-medium">
                                        Cancel
                                    </button>
                                    <button onClick={confirmDelete} className="flex-1 px-4 py-3 bg-red-500 hover:bg-red-600 text-white rounded-xl transition-colors font-medium">
                                        Delete
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    {showClearConfirm && (
                        <div className="fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center z-50 p-4">
                            <div className="bg-white rounded-2xl p-6 max-w-sm w-full shadow-2xl">
                                <h3 className="text-xl font-bold text-gray-800 mb-3">Clear All Records?</h3>
                                <p className="text-gray-600 mb-6">This will permanently delete all your time tracking data.</p>
                                <div className="flex gap-3">
                                    <button onClick={() => setShowClearConfirm(false)} className="flex-1 px-4 py-3 bg-gray-100 hover:bg-gray-200 text-gray-800 rounded-xl transition-colors font-medium">
                                        Cancel
                                    </button>
                                    <button onClick={confirmClearAll} className="flex-1 px-4 py-3 bg-red-500 hover:bg-red-600 text-white rounded-xl transition-colors font-medium">
                                        Clear All
                                    </button>
                                </div>
                            </div>
                        </div>
                    )}

                    <div className="bg-blue-500 text-white p-4 shadow-lg">
                        <div className="flex items-center justify-between">
                            <div className="flex items-center gap-3">
                                <Clock />
                                <div>
                                    <h1 className="text-xl font-bold">Time Tracking</h1>
                                    {isSyncing && <p className="text-xs opacity-90">Syncing...</p>}
                                </div>
                            </div>
                            <div className="flex gap-2">
                                <button onClick={clearAllData} className="p-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors">
                                    <Trash2 />
                                </button>
                                <button onClick={exportToExcel} className="p-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors">
                                    <Download />
                                </button>
                                <button onClick={handleLogout} className="p-2 bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors">
                                    <Lock />
                                </button>
                            </div>
                        </div>
                    </div>

                    <div className="p-4 pb-20">
                        <div className="bg-white rounded-2xl shadow-md p-5 mb-4">
                            <h2 className="text-lg font-bold text-gray-800 mb-4">Clock In/Out</h2>

                            <div className="mb-4">
                                <label className="block text-sm font-medium text-gray-700 mb-2">Your Name</label>
                                <input
                                    type="text"
                                    value={employeeName}
                                    onChange={(e) => handleEmployeeNameChange(e.target.value)}
                                    className="w-full px-4 py-3 border-2 border-gray-200 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-base"
                                />
                            </div>

                            <div className="grid grid-cols-2 gap-3 mb-4">
                                <div className="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-4 text-center">
                                    <p className="text-xs text-gray-600 mb-1">Time In</p>
                                    <p className="text-2xl font-bold text-blue-600">
                                        {timeInRecorded ? formatTime(timeInRecorded) : formatTime(currentTime)}
                                    </p>
                                </div>
                                <div className="bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl p-4 text-center">
                                    <p className="text-xs text-gray-600 mb-1">Time Out</p>
                                    <p className="text-2xl font-bold text-gray-600">
                                        {timeOutRecorded ? formatTime(timeOutRecorded) : formatTime(currentTime)}
                                    </p>
                                </div>
                            </div>

                            <div className="grid grid-cols-2 gap-3">
                                <button
                                    onClick={handleTimeIn}
                                    disabled={records.some(record => !record.timeOut)}
                                    className={`${records.some(record => !record.timeOut) ? 'bg-blue-300' : 'bg-blue-500 active:bg-blue-600'} text-white font-bold py-4 rounded-xl transition-all flex items-center justify-center gap-2 shadow-lg`}
                                >
                                    <LogIn />
                                    <span>Time In</span>
                                </button>
                                <button
                                    onClick={handleTimeOut}
                                    disabled={!records.some(record => !record.timeOut)}
                                    className={`${!records.some(record => !record.timeOut) ? 'bg-gray-200 text-gray-400' : 'bg-gray-700 text-white active:bg-gray-800'} font-bold py-4 rounded-xl transition-all flex items-center justify-center gap-2 shadow-lg`}
                                >
                                    <LogOut />
                                    <span>Time Out</span>
                                </button>
                            </div>
                        </div>

                        <div className="bg-white rounded-2xl shadow-md p-5">
                            <div className="flex items-center justify-between mb-4">
                                <div>
                                    <h2 className="text-lg font-bold text-gray-800">Records</h2>
                                    <p className="text-sm text-gray-600">
                                        {filteredRecords.length === records.length 
                                            ? `${records.length} total`
                                            : `${filteredRecords.length} of ${records.length}`}
                                    </p>
                                </div>
                                <button 
                                    onClick={() => setShowFilters(!showFilters)}
                                    className="p-2 bg-gray-100 rounded-lg"
                                >
                                    <Filter />
                                </button>
                            </div>

                            {showFilters && (
                                <div className="bg-gray-50 p-4 rounded-xl mb-4">
                                    <div className="space-y-3">
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Date</label>
                                            <input
                                                type="date"
                                                value={filterDate}
                                                onChange={(e) => setFilterDate(e.target.value)}
                                                className="w-full px-3 py-2 border-2 border-gray-200 rounded-lg"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium text-gray-700 mb-2">Day</label>
                                            <select
                                                value={filterDay}
                                                onChange={(e) => setFilterDay(e.target.value)}
                                                className="w-full px-3 py-2 border-2 border-gray-200 rounded-lg"
                                            >
                                                <option value="">All Days</option>
                                                <option value="Monday">Monday</option>
                                                <option value="Tuesday">Tuesday</option>
                                                <option value="Wednesday">Wednesday</option>
                                                <option value="Thursday">Thursday</option>
                                                <option value="Friday">Friday</option>
                                                <option value="Saturday">Saturday</option>
                                                <option value="Sunday">Sunday</option>
                                            </select>
                                        </div>
                                        <button onClick={clearFilters} className="w-full py-2 bg-gray-200 hover:bg-gray-300 rounded-lg font-medium flex items-center justify-center gap-2">
                                            <X />
                                            Clear Filters
                                        </button>
                                    </div>
                                </div>
                            )}

                            {filteredRecords.length === 0 ? (
                                <div className="text-center py-12 text-gray-400">
                                    {records.length === 0 
                                        ? 'No records yet'
                                        : 'No matching records'}
                                </div>
                            ) : (
                                <div className="space-y-3">
                                    {filteredRecords.map((record) => (
                                        <div key={record.id} className="bg-gray-50 rounded-xl p-4">
                                            <div className="flex justify-between items-start mb-2">
                                                <div>
                                                    <p className="font-bold text-gray-800">{record.name}</p>
                                                    <p className="text-sm text-gray-600">{record.date} ‚Ä¢ {record.dayOfWeek}</p>
                                                </div>
                                                <button onClick={() => deleteRecord(record.id)} className="text-red-500 p-2">
                                                    <Trash2 />
                                                </button>
                                            </div>
                                            <div className="flex gap-4 text-sm">
                                                <div>
                                                    <span className="text-gray-500">In:</span>
                                                    <span className="font-semibold text-gray-800 ml-1">{record.timeIn}</span>
                                                </div>
                                                <div>
                                                    <span className="text-gray-500">Out:</span>
                                                    <span className="font-semibold text-gray-800 ml-1">
                                                        {record.timeOut || <span className="text-orange-500">Pending</span>}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<BiometricTimeTracking />, document.getElementById('root'));
    </script>
</body>
</html>
